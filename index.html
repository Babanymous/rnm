<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rick's Multiverse Atlas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: #000;
            overflow: hidden;
            color: #00ff00;
            touch-action: none;
        }
        
        #canvas-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        
        #hud {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 20, 0, 0.95);
            border: 3px solid #00ff00;
            padding: 12px;
            font-size: 11px;
            max-width: 350px;
            z-index: 100;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }
        
        #hud h2 {
            color: #00ffff;
            margin-bottom: 8px;
            text-shadow: 0 0 10px #00ffff;
            font-size: 15px;
            letter-spacing: 1px;
        }
        
        #dimension-info {
            margin-top: 8px;
            padding: 8px;
            background: rgba(0, 50, 0, 0.5);
            border-left: 3px solid #00ff00;
            max-height: 250px;
            overflow-y: auto;
        }
        
        .dimension-label {
            color: #ffff00;
            font-weight: bold;
            font-size: 12px;
        }
        
        .status {
            color: #00ff00;
            animation: blink 1.5s infinite;
        }
        
        @keyframes blink {
            0%, 50%, 100% { opacity: 1; }
            25%, 75% { opacity: 0.5; }
        }
        
        #controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 20, 0, 0.95);
            border: 3px solid #00ff00;
            padding: 10px;
            font-size: 10px;
            z-index: 100;
        }
        
        #view-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 20, 0, 0.95);
            border: 3px solid #00ff00;
            padding: 10px;
            z-index: 100;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .view-btn {
            background: rgba(0, 255, 0, 0.2);
            border: 2px solid #00ff00;
            color: #00ff00;
            padding: 8px 12px;
            margin: 3px 0;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 10px;
            transition: all 0.2s;
            width: 100%;
            text-align: left;
        }
        
        .view-btn:hover {
            background: rgba(0, 255, 0, 0.4);
        }
        
        .view-btn:active, .view-btn.active {
            background: rgba(0, 255, 0, 0.6);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.7);
        }
        
        .category-header {
            color: #00ffff;
            font-weight: bold;
            margin-top: 8px;
            margin-bottom: 3px;
            font-size: 11px;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(0, 20, 0, 0.95);
            border: 2px solid #00ffff;
            padding: 8px;
            font-size: 10px;
            pointer-events: none;
            display: none;
            z-index: 200;
            max-width: 280px;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.7);
        }
        
        .threat-tag {
            display: inline-block;
            padding: 2px 6px;
            margin-left: 5px;
            border-radius: 3px;
            font-size: 8px;
            font-weight: bold;
        }
        
        .threat-safe { background: #00ff00; color: #000; }
        .threat-low { background: #88ff00; color: #000; }
        .threat-medium { background: #ffff00; color: #000; }
        .threat-high { background: #ff6600; color: #000; }
        .threat-extreme { background: #ff0000; color: #fff; }
        .threat-unknown { background: #9900ff; color: #fff; }
        
        @media (max-width: 768px) {
            #hud {
                font-size: 9px;
                max-width: 240px;
                padding: 8px;
            }
            
            #hud h2 {
                font-size: 12px;
            }
            
            #controls {
                font-size: 8px;
                padding: 6px;
            }
            
            .view-btn {
                padding: 6px 10px;
                font-size: 9px;
                margin: 2px 0;
            }
            
            #view-controls {
                padding: 6px;
                max-height: 70vh;
            }
        }
        
        @media (max-width: 480px) {
            #hud {
                font-size: 8px;
                max-width: 170px;
                padding: 6px;
            }
            
            #hud h2 {
                font-size: 10px;
            }
            
            #controls {
                font-size: 7px;
                padding: 5px;
                max-width: 140px;
            }
            
            .view-btn {
                padding: 5px 8px;
                font-size: 8px;
            }
            
            .tooltip {
                font-size: 8px;
                max-width: 200px;
            }
        }
        
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.5);
        }
        
        ::-webkit-scrollbar-thumb {
            background: #00ff00;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #00ffff;
        }
    </style>
</head>
<body>
    <div id="canvas-container"></div>
    
    <div id="hud">
        <h2>‚ö° MULTIVERSE ATLAS ‚ö°</h2>
        <div>Status: <span class="status">SCANNING</span></div>
        <div>Dimensions: <span id="dim-count">0</span></div>
        <div>Portal Stability: <span class="status">94.3%</span></div>
        <div id="dimension-info">
            <div class="dimension-label">üëÜ Select a dimension</div>
            <div style="font-size: 9px; margin-top: 5px; color: #00ffff; font-style: italic;">
                *burp* Infinite dimensions, Morty. Infinite possibilities.
            </div>
        </div>
    </div>
    
    <div id="view-controls">
        <div class="category-header">üéØ QUICK VIEWS</div>
        <button class="view-btn active" onclick="setView('overview')">üìç FULL MAP</button>
        <button class="view-btn" onclick="setView('central')">üèõÔ∏è CENTRAL CITADEL</button>
        <button class="view-btn" onclick="setView('earth')">üåç EARTH CLUSTER</button>
        <button class="view-btn" onclick="setView('danger')">‚ö†Ô∏è DANGER ZONES</button>
        
        <div class="category-header">üåÄ PORTAL TRAVEL</div>
        <button class="view-btn" onclick="portalJump()">üåÄ RANDOM JUMP</button>
        <button class="view-btn" onclick="goToDimension('citadel')">üèõÔ∏è CITADEL</button>
        <button class="view-btn" onclick="goToDimension('c137')">üî¥ C-137</button>
        <button class="view-btn" onclick="goToDimension('replacement')">üü¢ HOME</button>
        
        <div class="category-header">üîç FILTERS</div>
        <button class="view-btn" onclick="filterThreat('extreme')">üî¥ EXTREME</button>
        <button class="view-btn" onclick="filterThreat('high')">üü† HIGH</button>
        <button class="view-btn" onclick="filterThreat('all')">‚ö™ SHOW ALL</button>
        
        <div class="category-header">‚öôÔ∏è</div>
        <button class="view-btn" onclick="resetCamera()">üîÑ RESET VIEW</button>
    </div>
    
    <div id="controls">
        <strong>CONTROLS:</strong><br>
        <strong>Desktop:</strong><br>
        ‚Ä¢ Drag: Rotate<br>
        ‚Ä¢ Wheel: Zoom<br>
        ‚Ä¢ Click: Info<br>
        <strong>Touch:</strong><br>
        ‚Ä¢ 1 Finger: Rotate<br>
        ‚Ä¢ Pinch: Zoom<br>
        ‚Ä¢ Tap: Select
    </div>
    
    <div id="tooltip" class="tooltip"></div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // Complete Rick and Morty Multiverse Data
        const multiverseData = [
            // EARTH DIMENSIONS
            {
                id: 'c137',
                name: "Dimension C-137",
                designation: "C-137",
                type: "Earth Dimension",
                threat: "extreme",
                color: 0xff0000,
                position: [0, 0, 0],
                size: 1.4,
                description: "Rick's original dimension. Completely Cronenberged after failed love potion.",
                features: ["Abandoned", "Cronenberg Monsters", "Original Rick's Home"],
                rickComment: "*burp* My original dimension, Morty. We Cronenberged it real good."
            },
            {
                id: 'replacement',
                name: "Replacement Dimension",
                designation: "Unknown",
                type: "Earth Dimension",
                threat: "medium",
                color: 0x00ff00,
                position: [4, 2, 3],
                size: 1.3,
                description: "Current home of Rick C-137 and Morty. They replaced their dead counterparts.",
                features: ["Current Home", "Dead Rick & Morty Buried in Backyard", "Smith Family"],
                rickComment: "This is home now, Morty. Try not to think about the bodies in the backyard."
            },
            {
                id: 'cronenberg',
                name: "Cronenberg World",
                designation: "Cron-1",
                type: "Earth Dimension",
                threat: "extreme",
                color: 0x884444,
                position: [-3, -4, 2],
                size: 1.2,
                description: "Multiple dimensions where love potions went horribly wrong.",
                features: ["Body Horror", "Failed Love Potion", "Cronenberg Monsters"],
                rickComment: "We've Cronenberged a few worlds, Morty. Happens to the best of us. *burp*"
            },
            {
                id: 'fascist',
                name: "Fascist Dimension",
                designation: "Unknown",
                type: "Earth Dimension",
                threat: "extreme",
                color: 0x880000,
                position: [-6, 1, -4],
                size: 1.2,
                description: "Totalitarian dimension controlled by Fascist Morty.",
                features: ["Fascist Morty", "Militarized", "Eye Patch Morty"],
                rickComment: "Evil Morty's dimension. That kid's got ambition. And issues."
            },
            {
                id: 'pickle',
                name: "Pickle Rick Dimension",
                designation: "C-132",
                type: "Earth Dimension",
                threat: "low",
                color: 0x00ff66,
                position: [3, -2, -5],
                size: 1.0,
                description: "Where Rick turned himself into a pickle to avoid family therapy.",
                features: ["Pickle Rick", "Rat Sewer Battle", "Jaguar Encounter"],
                rickComment: "I'm Pickle Riiick! *burp* Greatest moment of my life, Morty."
            },
            {
                id: 'jerryd99',
                name: "Successful Jerry Dimension",
                designation: "D-99",
                type: "Earth Dimension",
                threat: "safe",
                color: 0xff6699,
                position: [-2, 4, 5],
                size: 0.9,
                description: "Statistical anomaly where Jerry is successful and confident.",
                features: ["Successful Jerry", "Doofus Rick", "Statistical Impossibility"],
                rickComment: "Jerry being successful? That's like... scientifically improbable."
            },
            
            // CITADEL & GOVERNMENT
            {
                id: 'citadel',
                name: "The Citadel",
                designation: "Citadel",
                type: "Government",
                threat: "high",
                color: 0xffaa00,
                position: [-5, 3, -1],
                size: 1.8,
                description: "Governmental center of the multiverse. Home to thousands of Ricks and Mortys.",
                features: ["Council of Ricks", "Simple Rick's", "Mortytown", "Evil Morty's Rise"],
                rickComment: "The Citadel. Where Ricks go to become sheep. Baaa. *burp*"
            },
            {
                id: 'customs',
                name: "Interdimensional Customs",
                designation: "Customs",
                type: "Government",
                threat: "medium",
                color: 0x666666,
                position: [0, 5, 1],
                size: 1.4,
                description: "Bureaucratic checkpoint between major dimensional clusters.",
                features: ["Customs Agents", "Megaseeds Illegal", "Bureaucracy"],
                rickComment: "Customs. Because even infinite dimensions need paperwork. *burp*"
            },
            {
                id: 'federation',
                name: "Galactic Federation HQ",
                designation: "Fed-1",
                type: "Government",
                threat: "low",
                color: 0x0066ff,
                position: [7, -1, 0],
                size: 1.5,
                description: "Former galactic government. Collapsed after Rick destroyed their economy.",
                features: ["Post-Collapse", "Birdperson's Capture", "Rick Destroyed It"],
                rickComment: "The Federation? I made their currency worthless. You're welcome."
            },
            
            // ALIEN WORLDS
            {
                id: 'birdworld',
                name: "Bird World",
                designation: "Bird-1",
                type: "Alien World",
                threat: "high",
                color: 0x00aa88,
                position: [8, 1, 3],
                size: 1.3,
                description: "Birdperson's home planet. Site of the tragic wedding massacre.",
                features: ["Birdperson/Phoenixperson", "Tammy's Betrayal", "Wedding Massacre"],
                rickComment: "Bird World. *burp* Tammy ruined my best friend's wedding there. Tammy sucks."
            },
            {
                id: 'gazorpazorp',
                name: "Gazorpazorp",
                designation: "Gazorp",
                type: "Alien World",
                threat: "high",
                color: 0xff3399,
                position: [-6, -3, -3],
                size: 1.3,
                description: "Matriarchal society. Males are violent and primitive.",
                features: ["Matriarchy", "Morty Jr.", "Sex Robot Origins", "Violent Males"],
                rickComment: "Planet of sexy female overlords and violent idiot males. Morty loved it."
            },
            {
                id: 'purgeplanet',
                name: "Purge Planet",
                designation: "Unknown",
                type: "Alien World",
                threat: "extreme",
                color: 0xff0066,
                position: [-7, 2, -2],
                size: 1.2,
                description: "Planet with annual purge festival. Extreme violence 24 hours a year.",
                features: ["Annual Purge", "Lighthouse Incident", "Extreme Violence"],
                rickComment: "Purge Planet. One day a year they just... go nuts. We fit right in. *burp*"
            },
            {
                id: 'gearworld',
                name: "Gear World",
                designation: "Gear",
                type: "Alien World",
                threat: "safe",
                color: 0xcccccc,
                position: [4, -3, 3],
                size: 1.0,
                description: "Dimension of sentient mechanical beings. Gearhead's home.",
                features: ["Gear People", "Revolio Clockberg Jr.", "Mechanical Life"],
                rickComment: "Gear World. Everyone's a gear. It's actually pretty cool. Except Gearhead."
            },
            {
                id: 'unity',
                name: "Unity's Planet",
                designation: "Unknown",
                type: "Alien World",
                threat: "medium",
                color: 0x9966ff,
                position: [5, -4, -1],
                size: 1.4,
                description: "Planet controlled by hivemind entity Unity. Rick's ex-girlfriend.",
                features: ["Hivemind Unity", "Rick's Ex", "Total Assimilation", "Giraffe Incident"],
                rickComment: "Unity. We had something special, Morty. *burp* She's literally everyone."
            },
            {
                id: 'squanch',
                name: "Planet Squanch",
                designation: "Squanch",
                type: "Alien World",
                threat: "safe",
                color: 0xff9966,
                position: [2, -5, 0],
                size: 1.1,
                description: "Squanchy's home planet. Heavy partying culture.",
                features: ["Squanchy's Home", "Party Planet", "Squanch Language"],
                rickComment: "Planet Squanch. Where squanching is a way of squanch. You squanch?"
            },
            {
                id: 'zigerion',
                name: "Zigerion Homeworld",
                designation: "Unknown",
                type: "Alien World",
                threat: "low",
                color: 0xff6600,
                position: [-4, 5, 1],
                size: 0.9,
                description: "Home of scammer aliens who tried to steal portal formula.",
                features: ["Zigerion Scammers", "Simulation Obsessed", "Nudity Culture", "Prince of Persuasia"],
                rickComment: "Zigerions. Scammers who thought they could outsmart me. In a simulation. *burp*"
            },
            {
                id: 'pluto',
                name: "Pluto",
                designation: "Pluto",
                type: "Alien World",
                threat: "low",
                color: 0x8888ff,
                position: [7, 3, -4],
                size: 1.0,
                description: "Mining colony. Still believes it's a planet despite scientific consensus.",
                features: ["Plutonium Mining", "Planet Denial", "Scroopy Noopers", "Morty's Fame"],
                rickComment: "Pluto. NOT a planet, Morty! I don't care what those miners say!"
            },
            
            // POCKET DIMENSIONS & SPECIAL LOCATIONS
            {
                id: 'froopyland',
                name: "Froopyland",
                designation: "Froopy",
                type: "Pocket Dimension",
                threat: "high",
                color: 0xff99ff,
                position: [-1, -3, -3],
                size: 0.8,
                description: "Pocket dimension created by Rick for young Beth's imaginary friend.",
                features: ["Beth's Creation", "Cannibalistic Tommy", "Imaginary Land Made Real"],
                rickComment: "Made this for Beth when she was a kid. *burp* Tommy got... creative."
            },
            {
                id: 'microverse',
                name: "Microverse Battery",
                designation: "Microverse",
                type: "Pocket Dimension",
                threat: "medium",
                color: 0xff9900,
                position: [-3, -5, 4],
                size: 0.7,
                description: "Miniature universe inside Rick's car battery. Powers his ship.",
                features: ["Miniverse Inside", "Teenyverse Inside That", "Slavery with Extra Steps"],
                rickComment: "My car battery. It's a universe, Morty. Slavery with extra steps. *burp*"
            },
            {
                id: 'anatomypark',
                name: "Anatomy Park",
                designation: "Unknown",
                type: "Pocket Dimension",
                threat: "medium",
                color: 0xff3300,
                position: [4, 3, -4],
                size: 0.6,
                description: "Miniaturized theme park inside a homeless man's body.",
                features: ["Inside Ruben", "Miniaturization Tech", "Pirates of the Pancreas"],
                rickComment: "Anatomy Park! Built it inside a hobo. He died. Park's closed now. *burp*"
            },
            {
                id: 'jerryboree',
                name: "Jerryboree",
                designation: "Jerry-Care",
                type: "Pocket Dimension",
                threat: "safe",
                color: 0xffcc99,
                position: [3, 6, -1],
                size: 1.0,
                description: "Daycare facility for Jerrys from across infinite dimensions.",
                features: ["Jerry Daycare", "Infinite Jerrys", "Ticket System", "Jerry Swap"],
                rickComment: "Jerryboree. Where we dump Jerry when we go on adventures. *burp*"
            },
            {
                id: 'blender',
                name: "Blender Dimension",
                designation: "5-126",
                type: "Pocket Dimension",
                threat: "extreme",
                color: 0x990099,
                position: [-5, -4, 2],
                size: 1.0,
                description: "Dimension consisting entirely of blended matter. Constant screaming.",
                features: ["Everything Blended", "Constant Screaming", "DO NOT ENTER"],
                rickComment: "Blender Dimension. Everything's blended. Everyone's screaming. Don't go there."
            },
            
            // BIZARRE DIMENSIONS
            {
                id: 'pizzaphone',
                name: "Pizza Phone Dimension",
                designation: "35-C",
                type: "Bizarre",
                threat: "safe",
                color: 0xff00ff,
                position: [-4, -2, 3],
                size: 0.9,
                description: "Dimension where pizza is used as phones and phones are eaten.",
                features: ["Pizza Phones", "Phone Food", "Harmless Oddity"],
                rickComment: "Pizza phone dimension. Phones are food, pizza is communication. Makes sense."
            },
            {
                id: 'chairpeople',
                name: "Chair People Dimension",
                designation: "C-500A",
                type: "Bizarre",
                threat: "medium",
                color: 0xffff00,
                position: [6, 0, -3],
                size: 0.9,
                description: "People are chairs and chairs are people. Existentially disturbing.",
                features: ["Chair People", "People Chairs", "Existential Crisis"],
                rickComment: "Chair people. Sit on people, people sit. It's weird, Morty."
            },
            {
                id: 'hamsterbutt',
                name: "Hamster in Butt World",
                designation: "Unknown",
                type: "Bizarre",
                threat: "safe",
                color: 0xaa6600,
                position: [2, -4, -2],
                size: 0.8,
                description: "Humans have hamsters living in their rectums. Symbiotic relationship.",
                features: ["Hamsters in Butts", "Symbiotic", "Surprisingly Normal"],
                rickComment: "Everyone's got hamsters in their butts. They seem fine with it. *burp*"
            },
            {
                id: 'shrimpcolors',
                name: "Shrimp Colors Dimension",
                designation: "Unknown",
                type: "Bizarre",
                threat: "safe",
                color: 0xff00aa,
                position: [6, 5, 2],
                size: 0.8,
                description: "Beings see 16 primary colors like mantis shrimp. Incomprehensible to humans.",
                features: ["16 Primary Colors", "Mantis Shrimp Vision", "Incomprehensible Hues"],
                rickComment: "They see colors we can't even imagine, Morty. Like... blurple. *burp*"
            },
            {
                id: 'giants',
                name: "Giant Dimension",
                designation: "Giant",
                type: "Bizarre",
                threat: "medium",
                color: 0xaa88ff,
                position: [-8, 2, 0],
                size: 1.6,
                description: "Everything is giant-sized. People, objects, problems.",
                features: ["Giant Everything", "Scale Anomaly", "Big Problems"],
                rickComment: "Giant dimension. Everything's big. Including the egos."
            },
            {
                id: 'doofus',
                name: "Doofus Rick Dimension",
                designation: "J19Œ∂7",
                type: "Bizarre",
                threat: "safe",
                color: 0x00aaff,
                position: [3, -3, 4],
                size: 1.0,
                description: "Rick developed technology without weapons. Eats his own poop.",
                features: ["Doofus Rick", "Peaceful Tech", "Ovenless Brownies", "Eats Poop"],
                rickComment: "Doofus Rick's dimension. They eat poop there. He's actually pretty smart though."
            },
            
            // STORY-SPECIFIC LOCATIONS
            {
                id: 'vindicators',
                name: "Vindicators HQ",
                designation: "Vindi-1",
                type: "Hero World",
                threat: "medium",
                color: 0x0099ff,
                position: [5, -5, 3],
                size: 1.2,
                description: "Home base of the Vindicators superhero team.",
                features: ["Superhero Team", "Drunk Rick's Traps", "Million Ants Died"],
                rickComment: "Vindicators. Bunch of knockoff Avengers. I SAW TRAP laid death traps for them drunk."
            },
            {
                id: 'atlantis',
                name: "Atlantis",
                designation: "Atlant",
                type: "Hidden World",
                threat: "safe",
                color: 0x0066aa,
                position: [-2, 6, 4],
                size: 1.1,
                description: "Underwater civilization. Technologically advanced but extremely petty.",
                features: ["Underwater City", "Mer-People", "Rick Hates Them", "Heist"],
                rickComment: "Atlantis. *burp* Bunch of pretentious fish people. They suck."
            },
            {
                id: 'deathcrystal',
                name: "Death Crystal Dimension",
                designation: "D-Cry",
                type: "Mystic",
                threat: "high",
                color: 0xff0099,
                position: [-6, -5, 5],
                size: 0.9,
                description: "Source of death crystals showing infinite death possibilities.",
                features: ["Death Crystals", "Akira Slide", "Infinite Death Timelines"],
                rickComment: "Death crystals. Show you how you die. Morty got obsessed. Bad times. *burp*"
            },
            {
                id: 'storytrain',
                name: "Story Train",
                designation: "Story",
                type: "Meta",
                threat: "medium",
                color: 0x9999ff,
                position: [7, -4, -2],
                size: 1.0,
                description: "Literal narrative-driven dimension with story structure.",
                features: ["Meta-Narrative", "Story Lord", "Anthology Episodes"],
                rickComment: "Story Train. It's all meta and annoying. Like this conversation. *burp*"
            },
            {
                id: 'heistcon',
                name: "Heist-Con",
                designation: "Heist",
                type: "Convention",
                threat: "safe",
                color: 0xff6633,
                position: [8, 4, -1],
                size: 0.9,
                description: "Annual convention for heist enthusiasts across the multiverse.",
                features: ["Heist Culture", "Randotron", "Mr. Poopybutthole Attends"],
                rickComment: "Heist-Con. Where losers celebrate convoluted plans. *burp* I hate heists."
            },
            {
                id: 'interdimcable',
                name: "Interdimensional Cable Hub",
                designation: "IC-Prime",
                type: "Media Center",
                threat: "safe",
                color: 0xaa00aa,
                position: [4, 4, 5],
                size: 0.8,
                description: "Source of infinite TV channels from across dimensions.",
                features: ["Infinite TV", "Ball Fondlers", "Ants in My Eyes Johnson"],
                rickComment: "Interdimensional cable. Infinite channels of garbage. I love it. *burp*"
            },
            
            // DANGER ZONES
            {
                id: 'testicle',
                name: "Testicle Monster Dimension",
                designation: "Unknown",
                type: "Danger Zone",
                threat: "extreme",
                color: 0xcc6699,
                position: [-4, -6, -1],
                size: 1.0,
                description: "Hostile dimension populated by aggressive testicle monsters.",
                features: ["Testicle Monsters", "Extremely Hostile", "Bizarre Biology"],
                rickComment: "Testicle monsters everywhere. We don't go there anymore. *burp*"
            },
            {
                id: 'worldender',
                name: "Worldender's Lair",
                designation: "W-End",
                type: "Danger Zone",
                threat: "low",
                color: 0x666699,
                position: [-5, 6, 2],
                size: 0.9,
                description: "Former domain of Worldender. Now abandoned after Vindicators mission.",
                features: ["Post-Worldender", "Abandoned", "Drunk Rick Won"],
                rickComment: "Worldender's place. I killed him while blackout drunk. Classic me. *burp*"
            },
            {
                id: 'timefrozen',
                name: "Time-Frozen Dimension",
                designation: "K-83",
                type: "Anomaly",
                threat: "high",
                color: 0x00ffff,
                position: [5, 3, 1],
                size: 1.0,
                description: "Dimension with severe temporal anomalies and frozen entities.",
                features: ["Time Frozen", "Temporal Anomalies", "Dangerous Physics"],
                rickComment: "Time doesn't work right there. Everything's frozen. Except it's not. *burp*"
            },
            {
                id: 'vat',
                name: "Fake Vat of Acid",
                designation: "Acid",
                type: "Memory",
                threat: "safe",
                color: 0x99ff00,
                position: [7, -5, -4],
                size: 0.7,
                description: "Location of Rick's fake vat of acid that saved their lives.",
                features: ["Fake Acid", "Morty's Save Device", "Morty's Girlfriends"],
                rickComment: "The vat was real, Morty! You just didn't believe in it! *burp*"
            },
            {
                id: 'mindblowers',
                name: "Morty's Mind Blowers Storage",
                designation: "Memory",
                type: "Storage",
                threat: "medium",
                color: 0xff66ff,
                position: [6, -3, -5],
                size: 0.8,
                description: "Where erased memories are stored. Contains dangerous truths.",
                features: ["Memory Storage", "Truth Serum Incident", "Squirrel Truth"],
                rickComment: "Your mind blowers, Morty. Memories too traumatic to keep. *burp*"
            }
        ];
        
        // Scene setup
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000510);
        scene.fog = new THREE.Fog(0x000510, 30, 150);
        
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 500);
        camera.position.set(0, 25, 50);
        camera.lookAt(0, 0, 0);
        
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);
        
        // Lighting
        const ambientLight = new THREE.AmbientLight(0x1a1a2e, 0.4);
        scene.add(ambientLight);
        
        const greenLight = new THREE.PointLight(0x00ff00, 1.5, 100);
        greenLight.position.set(0, 20, 20);
        scene.add(greenLight);
        
        const cyanLight = new THREE.PointLight(0x00ffff, 1, 80);
        cyanLight.position.set(-20, -10, 20);
        scene.add(cyanLight);
        
        // Create starfield
        const starGeometry = new THREE.BufferGeometry();
        const starVertices = [];
        const starColors = [];
        for (let i = 0; i < 6000; i++) {
            const x = (Math.random() - 0.5) * 500;
            const y = (Math.random() - 0.5) * 500;
            const z = (Math.random() - 0.5) * 500;
            starVertices.push(x, y, z);
            
            const colorChoice = Math.random();
            if (colorChoice < 0.6) {
                starColors.push(1, 1, 1);
            } else if (colorChoice < 0.8) {
                starColors.push(0.3, 1, 1);
            } else {
                starColors.push(0.3, 1, 0.5);
            }
        }
        starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
        starGeometry.setAttribute('color', new THREE.Float32BufferAttribute(starColors, 3));
        const starMaterial = new THREE.PointsMaterial({ 
            size: 0.3,
            vertexColors: true,
            transparent: true,
            opacity: 0.9
        });
        const stars = new THREE.Points(starGeometry, starMaterial);
        scene.add(stars);
        
        // Create dimensions
        const dimensionObjects = [];
        const dimensionMap = new Map();
        let hiddenDimensions = new Set();
        
        multiverseData.forEach(dimData => {
            const group = new THREE.Group();
            
            // Create dimension sphere with toon shading
            const geometry = new THREE.SphereGeometry(dimData.size, 32, 32);
            const material = new THREE.MeshToonMaterial({
                color: dimData.color,
                emissive: dimData.color,
                emissiveIntensity: 0.2
            });
            const sphere = new THREE.Mesh(geometry, material);
            sphere.userData = dimData;
            sphere.position.set(...dimData.position);
            
            // Thick black outline
            const outlineGeometry = new THREE.SphereGeometry(dimData.size * 1.12, 32, 32);
            const outlineMaterial = new THREE.MeshBasicMaterial({
                color: 0x000000,
                side: THREE.BackSide
            });
            const outline = new THREE.Mesh(outlineGeometry, outlineMaterial);
            sphere.add(outline);
            
            // Label
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = 512;
            canvas.height = 128;
            
            context.fillStyle = 'rgba(0, 0, 0, 0.8)';
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            context.strokeStyle = '#00ff00';
            context.lineWidth = 4;
            context.strokeRect(5, 5, canvas.width - 10, canvas.height - 10);
            
            context.fillStyle = '#00ff00';
            context.font = 'Bold 32px Arial';
            context.textAlign = 'center';
            context.fillText(dimData.designation, 256, 50);
            
            const threatColors = {
                'safe': '#00ff00',
                'low': '#88ff00',
                'medium': '#ffff00',
                'high': '#ff6600',
                'extreme': '#ff0000',
                'unknown': '#9900ff'
            };
            context.fillStyle = threatColors[dimData.threat];
            context.font = 'Bold 24px Arial';
            context.fillText(`[${dimData.threat.toUpperCase()}]`, 256, 90);
            
            const texture = new THREE.CanvasTexture(canvas);
            const spriteMaterial = new THREE.SpriteMaterial({ 
                map: texture, 
                transparent: true 
            });
            const sprite = new THREE.Sprite(spriteMaterial);
            sprite.scale.set(4, 1, 1);
            sprite.position.y = dimData.size + 1.5;
            sphere.add(sprite);
            
            group.add(sphere);
            scene.add(group);
            dimensionObjects.push(group);
            dimensionMap.set(dimData.id, group);
        });
        
        document.getElementById('dim-count').textContent = multiverseData.length;
        
        // Portal connections
        const connections = [
            ['c137', 'replacement'],
            ['c137', 'cronenberg'],
            ['c137', 'citadel'],
            ['replacement', 'citadel'],
            ['citadel', 'customs'],
            ['citadel', 'doofus'],
            ['citadel', 'jerryboree'],
            ['federation', 'citadel'],
            ['birdworld', 'federation'],
            ['unity', 'replacement'],
            ['microverse', 'replacement'],
            ['froopyland', 'replacement'],
            ['gazorpazorp', 'citadel'],
            ['fascist', 'citadel']
        ];
        
        const portalLines = [];
        connections.forEach(([id1, id2]) => {
            const dim1 = dimensionMap.get(id1);
            const dim2 = dimensionMap.get(id2);
            
            if (dim1 && dim2) {
                const points = [
                    dim1.children[0].position,
                    dim2.children[0].position
                ];
                const geometry = new THREE.BufferGeometry().setFromPoints(points);
                const material = new THREE.LineDashedMaterial({
                    color: 0x00ff00,
                    transparent: true,
                    opacity: 0.3,
                    dashSize: 0.5,
                    gapSize: 0.3
                });
                const line = new THREE.Line(geometry, material);
                line.computeLineDistances();
                scene.add(line);
                portalLines.push(line);
            }
        });
        
        // Interaction
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        const tooltip = document.getElementById('tooltip');
        const dimensionInfo = document.getElementById('dimension-info');
        
        let isDragging = false;
        let previousMousePosition = { x: 0, y: 0 };
        let selectedObject = null;
        let touchStartDistance = 0;
        let initialCameraZ = camera.position.z;
        let isTouching = false;
        
        // Mouse events
        renderer.domElement.addEventListener('mousedown', (e) => {
            isDragging = true;
            previousMousePosition = { x: e.clientX, y: e.clientY };
        });
        
        renderer.domElement.addEventListener('mouseup', () => {
            isDragging = false;
        });
        
        renderer.domElement.addEventListener('mousemove', handleMove);
        
        // Touch events
        renderer.domElement.addEventListener('touchstart', (e) => {
            e.preventDefault();
            isTouching = true;
            
            if (e.touches.length === 1) {
                previousMousePosition = { 
                    x: e.touches[0].clientX, 
                    y: e.touches[0].clientY 
                };
            } else if (e.touches.length === 2) {
                const dx = e.touches[0].clientX - e.touches[1].clientX;
                const dy = e.touches[0].clientY - e.touches[1].clientY;
                touchStartDistance = Math.sqrt(dx * dx + dy * dy);
                initialCameraZ = camera.position.z;
            }
        }, { passive: false });
        
        renderer.domElement.addEventListener('touchmove', (e) => {
            e.preventDefault();
            
            if (e.touches.length === 1) {
                const deltaX = e.touches[0].clientX - previousMousePosition.x;
                const deltaY = e.touches[0].clientY - previousMousePosition.y;
                
                camera.position.applyAxisAngle(new THREE.Vector3(0, 1, 0), deltaX * 0.005);
                
                previousMousePosition = { 
                    x: e.touches[0].clientX, 
                    y: e.touches[0].clientY 
                };
                
                camera.lookAt(0, 0, 0);
            } else if (e.touches.length === 2) {
                const dx = e.touches[0].clientX - e.touches[1].clientX;
                const dy = e.touches[0].clientY - e.touches[1].clientY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                const scale = touchStartDistance / distance;
                const newZ = initialCameraZ * scale;
                
                const currentDistance = camera.position.length();
                const targetDistance = Math.max(15, Math.min(100, newZ));
                
                camera.position.normalize().multiplyScalar(targetDistance);
                camera.lookAt(0, 0, 0);
            }
        }, { passive: false });
        
        renderer.domElement.addEventListener('touchend', (e) => {
            if (e.touches.length === 0) {
                isTouching = false;
                
                if (e.changedTouches.length === 1) {
                    const touch = e.changedTouches[0];
                    mouse.x = (touch.clientX / window.innerWidth) * 2 - 1;
                    mouse.y = -(touch.clientY / window.innerHeight) * 2 + 1;
                    
                    raycaster.setFromCamera(mouse, camera);
                    const allMeshes = [];
                    dimensionObjects.forEach(group => {
                        group.traverse(obj => {
                            if (obj.isMesh && obj.userData.name) {
                                allMeshes.push(obj);
                            }
                        });
                    });
                    
                    const intersects = raycaster.intersectObjects(allMeshes);
                    if (intersects.length > 0) {
                        selectDimension(intersects[0].object);
                    }
                }
            }
        });
        
        function handleMove(e) {
            if (isDragging) {
                const deltaX = e.clientX - previousMousePosition.x;
                camera.position.applyAxisAngle(new THREE.Vector3(0, 1, 0), deltaX * 0.005);
                previousMousePosition = { x: e.clientX, y: e.clientY };
                camera.lookAt(0, 0, 0);
            }
            
            mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
            
            if (!isTouching) {
                raycaster.setFromCamera(mouse, camera);
                const allMeshes = [];
                dimensionObjects.forEach(group => {
                    group.traverse(obj => {
                        if (obj.isMesh && obj.userData.name) {
                            allMeshes.push(obj);
                        }
                    });
                });
                
                const intersects = raycaster.intersectObjects(allMeshes);
                
                if (intersects.length > 0) {
                    const data = intersects[0].object.userData;
                    tooltip.style.display = 'block';
                    tooltip.style.left = e.clientX + 15 + 'px';
                    tooltip.style.top = e.clientY + 15 + 'px';
                    
                    const threatClass = `threat-${data.threat}`;
                    tooltip.innerHTML = `
                        <strong style="color: #00ffff;">${data.name}</strong>
                        <span class="threat-tag ${threatClass}">${data.threat.toUpperCase()}</span><br>
                        <em style="color: #88ff88;">${data.type}</em><br>
                        <div style="margin-top: 3px; font-size: 9px;">${data.description}</div>
                    `;
                } else {
                    tooltip.style.display = 'none';
                }
            }
        }
        
        renderer.domElement.addEventListener('click', (e) => {
            if (isTouching) return;
            
            raycaster.setFromCamera(mouse, camera);
            const allMeshes = [];
            dimensionObjects.forEach(group => {
                group.traverse(obj => {
                    if (obj.isMesh && obj.userData.name) {
                        allMeshes.push(obj);
                    }
                });
            });
            
            const intersects = raycaster.intersectObjects(allMeshes);
            if (intersects.length > 0) {
                selectDimension(intersects[0].object);
            }
        });
        
        function selectDimension(obj) {
            if (selectedObject) {
                selectedObject.material.emissiveIntensity = 0.2;
            }
            
            selectedObject = obj;
            selectedObject.material.emissiveIntensity = 0.8;
            
            const data = selectedObject.userData;
            const threatClass = `threat-${data.threat}`;
            
            let featuresHTML = '';
            if (data.features) {
                featuresHTML = '<div style="margin-top: 5px;"><strong>Features:</strong></div><div style="margin-left: 10px; font-size: 9px;">';
                featuresHTML += data.features.map(f => `‚Ä¢ ${f}`).join('<br>');
                featuresHTML += '</div>';
            }
            
            dimensionInfo.innerHTML = `
                <div class="dimension-label">${data.name}</div>
                <span class="threat-tag ${threatClass}">${data.threat.toUpperCase()}</span>
                <div style="color: #00ffff; margin-top: 3px;">${data.type}</div>
                <div style="margin-top: 5px; font-size: 10px;"><strong>Info:</strong> ${data.description}</div>
                ${featuresHTML}
                <div style="margin-top: 8px; padding: 5px; background: rgba(0, 100, 0, 0.3); border-left: 2px solid #00ffff; font-style: italic; color: #00ffff; font-size: 9px;">
                    ${data.rickComment}
                </div>
            `;
        }
        
        // Zoom
        renderer.domElement.addEventListener('wheel', (e) => {
            e.preventDefault();
            const zoomSpeed = 0.1;
            const currentDistance = camera.position.length();
            const newDistance = currentDistance + e.deltaY * zoomSpeed;
            const clampedDistance = Math.max(15, Math.min(100, newDistance));
            camera.position.normalize().multiplyScalar(clampedDistance);
            camera.lookAt(0, 0, 0);
        }, { passive: false });
        
        // View controls
        function setView(viewType) {
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            let targetPos;
            switch(viewType) {
                case 'overview':
                    targetPos = new THREE.Vector3(0, 25, 50);
                    break;
                case 'central':
                    const citadel = dimensionMap.get('citadel');
                    if (citadel) {
                        const pos = citadel.children[0].position;
                        targetPos = new THREE.Vector3(pos.x + 10, pos.y + 5, pos.z + 10);
                    }
                    break;
                case 'earth':
                    const earth = dimensionMap.get('replacement');
                    if (earth) {
                        const pos = earth.children[0].position;
                        targetPos = new THREE.Vector3(pos.x + 8, pos.y + 8, pos.z + 8);
                    }
                    break;
                case 'danger':
                    targetPos = new THREE.Vector3(-15, -10, 20);
                    break;
            }
            
            if (targetPos) animateCamera(targetPos);
        }
        
        function goToDimension(dimId) {
            const dim = dimensionMap.get(dimId);
            if (dim) {
                const sphere = dim.children[0];
                selectDimension(sphere);
                const pos = sphere.position;
                const targetPos = new THREE.Vector3(pos.x + 8, pos.y + 5, pos.z + 8);
                animateCamera(targetPos);
            }
        }
        
        function filterThreat(level) {
            if (level === 'all') {
                hiddenDimensions.clear();
                dimensionObjects.forEach(obj => obj.visible = true);
            } else {
                hiddenDimensions.clear();
                dimensionObjects.forEach(obj => {
                    const data = obj.children[0].userData;
                    if (data.threat !== level) {
                        obj.visible = false;
                        hiddenDimensions.add(data.id);
                    } else {
                        obj.visible = true;
                    }
                });
            }
        }
        
        function resetCamera() {
            animateCamera(new THREE.Vector3(0, 25, 50));
            document.querySelectorAll('.view-btn').forEach((btn, i) => {
                btn.classList.remove('active');
                if (i === 0) btn.classList.add('active');
            });
        }
        
        function animateCamera(targetPos) {
            const startPos = camera.position.clone();
            const duration = 1000;
            const startTime = Date.now();
            
            function animate() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const eased = 1 - Math.pow(1 - progress, 3);
                
                camera.position.lerpVectors(startPos, targetPos, eased);
                camera.lookAt(0, 0, 0);
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                }
            }
            
            animate();
        }
        
        function portalJump() {
            const portalFlash = new THREE.PointLight(0x00ff00, 10, 50);
            portalFlash.position.copy(camera.position);
            scene.add(portalFlash);
            
            const portalRingGeometry = new THREE.TorusGeometry(2, 0.5, 16, 32);
            const portalRingMaterial = new THREE.MeshBasicMaterial({
                color: 0x00ff00,
                transparent: true,
                opacity: 1,
                side: THREE.DoubleSide
            });
            const portalRing = new THREE.Mesh(portalRingGeometry, portalRingMaterial);
            portalRing.position.copy(camera.position);
            portalRing.lookAt(0, 0, 0);
            scene.add(portalRing);
            
            const particles = [];
            for (let i = 0; i < 30; i++) {
                const particleGeometry = new THREE.SphereGeometry(0.15, 8, 8);
                const particleMaterial = new THREE.MeshBasicMaterial({
                    color: 0x00ff00,
                    transparent: true,
                    opacity: 1
                });
                const particle = new THREE.Mesh(particleGeometry, particleMaterial);
                particle.position.copy(camera.position);
                
                const angle = (i / 30) * Math.PI * 2;
                const speed = 0.3 + Math.random() * 0.3;
                particle.userData.velocity = new THREE.Vector3(
                    Math.cos(angle) * speed,
                    Math.sin(angle) * speed,
                    (Math.random() - 0.5) * speed
                );
                scene.add(particle);
                particles.push(particle);
            }
            
            const visibleDimensions = dimensionObjects.filter(obj => obj.visible);
            const randomDim = visibleDimensions[Math.floor(Math.random() * visibleDimensions.length)];
            let targetPosition;
            
            if (randomDim) {
                const pos = randomDim.children[0].position;
                targetPosition = new THREE.Vector3(pos.x + 8, pos.y + 5, pos.z + 8);
                selectDimension(randomDim.children[0]);
            } else {
                targetPosition = new THREE.Vector3(
                    Math.random() * 40 - 20,
                    Math.random() * 20,
                    Math.random() * 40 - 20
                );
            }
            
            let frame = 0;
            const portalAnimation = setInterval(() => {
                frame++;
                
                const scale = 1 + frame * 0.4;
                portalRing.scale.set(scale, scale, scale);
                portalRing.material.opacity = Math.max(0, 1 - (frame / 25));
                portalRing.rotation.z += 0.1;
                
                particles.forEach(p => {
                    p.position.add(p.userData.velocity);
                    p.userData.velocity.y -= 0.02;
                    p.material.opacity = Math.max(0, 1 - (frame / 25));
                    
                    const wobble = Math.sin(frame * 0.3) * 0.1;
                    p.scale.set(1 + wobble, 1 + wobble, 1 + wobble);
                });
                
                portalFlash.intensity = Math.max(0, 10 - frame * 0.5);
                
                if (frame >= 25) {
                    clearInterval(portalAnimation);
                    scene.remove(portalFlash);
                    scene.remove(portalRing);
                    particles.forEach(p => scene.remove(p));
                }
            }, 30);
            
            setTimeout(() => {
                animateCamera(targetPosition);
            }, 300);
        }
        
        // Animation loop
        let time = 0;
        function animate() {
            requestAnimationFrame(animate);
            time += 0.01;
            
            // Rotate dimensions
            dimensionObjects.forEach((group, i) => {
                group.rotation.y += 0.005;
                
                // Pulse extreme threat dimensions
                const sphere = group.children[0];
                if (sphere.userData.threat === 'extreme') {
                    const pulse = Math.sin(time * 3 + i) * 0.1 + 1;
                    group.scale.set(pulse, pulse, pulse);
                }
            });
            
            // Pulse portal lines
            portalLines.forEach((line, i) => {
                line.material.opacity = 0.2 + Math.sin(time * 2 + i) * 0.15;
            });
            
            // Rotate starfield
            stars.rotation.y += 0.0002;
            stars.rotation.x += 0.0001;
            
            renderer.render(scene, camera);
        }
        
        animate();
        
        // Handle resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
